# rye:signed:2026-02-13T08:10:37Z:afc7d9e1b925f0c8c4cb52decf0d8cee3af9f76fc821c55e8798f0c99232bcbe:LKfJKqGSz_Rr6GH5ThcVWoz68GEqTb4x_KjyfoVYk2U4FJspVbINNU1hhxAebGeBn20Vd-gaCsALLSNzpcU8Bw==:440443d0858f0199
version: "1.0.0"
tool_type: runtime
executor_id: rye/core/primitives/subprocess
category: rye/core/runtimes
description: "Python function runtime - calls execute(params, project_path) and serializes result to stdout"

env_config:
  interpreter:
    type: venv_python
    venv_path: .venv
    var: RYE_PYTHON
    fallback: python3
  env:
    PYTHONUNBUFFERED: "1"
    PROJECT_VENV_PYTHON: "${RYE_PYTHON}"

config:
  command: "${RYE_PYTHON}"
  args:
    - "-c"
    - |
      import sys,json,importlib.util,inspect,asyncio
      spec=importlib.util.spec_from_file_location("tool",sys.argv[1])
      mod=importlib.util.module_from_spec(spec)
      spec.loader.exec_module(mod)
      fn=getattr(mod,"execute",None)
      if not fn:sys.exit("No execute() in "+sys.argv[1])
      p=json.loads(sys.argv[2])
      if inspect.iscoroutinefunction(fn):r=asyncio.run(fn(p,sys.argv[3]))
      else:r=fn(p,sys.argv[3])
      print(json.dumps(r,default=str)if r is not None else'{}')
    - "{tool_path}"
    - "{params_json}"
    - "{project_path}"
  timeout: 300

config_schema:
  type: object
  properties:
    script:
      type: string
      description: Python module with execute(params, project_path) function
